2021年9月中旬买的 vivo X70 pro+ 用了 4 年，Wi-Fi 故障，无法上网。询问 AI 后得知此法：手机通过数据线连接电脑，电脑用 adb + tinyproxy 给手机上网。终端执行结果记录如下，手机打开浏览器后的确可以上网。

```sh
Last login: Thu Nov 27 14:07:37 on ttys002
~ > adb devices
List of devices attached
1558369949000TE	device

~ > tinyproxy
WARNING: logging deactivated (can't log to stdout when daemonized)
~ >
~ > lsof -i -P | grep tinyproxy
tinyproxy 3878  zdt    1u  IPv6 0x5b178ce2f9b50bd2      0t0  TCP *:8888 (LISTEN)
tinyproxy 3878  zdt    2u  IPv4 0x64d54ca357be022b      0t0  TCP *:8888 (LISTEN)
~ >
~ > adb reverse --remove-all
~ > adb reverse tcp:8888 tcp:8888
8888
~ > adb shell settings put global http_proxy 127.0.0.1:8888
```

通过以下命令取消手机上网

```sh
adb shell settings put global http_proxy :0   # 清除代理
adb reverse --remove-all                      # 取消端口转发
```

再次敲入以下命令可以让手机重新上网

```sh
adb shell settings put global http_proxy 127.0.0.1:8888
```

通过以下命令关闭 Mac 后台运行的 tinyproxy

```sh
pkill pkill tinyproxy
```

### 命令解释

#### `adb devices`

能看到类似 `1558369949000TE device` 这样的输出，这说明手机已经被电脑识别。

#### `tinyproxy`

在后台运行 tinyproxy

#### `lsof -i -P | grep tinyproxy`

找到了 `tinyproxy` 正在监听的端口号为 8888

#### 建立 USB 端口转发

```
adb reverse --remove-all       # 先清理之前的反向端口转发
adb reverse tcp:8888 tcp:8888  # 让手机访问 127.0.0.1:8888 实际上访问到电脑的 tinyproxy
```

#### 在手机上设置代理

`adb shell settings put global http_proxy 127.0.0.1:8888`

这步让手机的全局 HTTP 流量都走电脑上的 tinyproxy，从而通过电脑上网。

✅ 结果：手机通过 USB 已经能上网了，不依赖 Wi-Fi。

### 缺点

手机智能通过浏览器上网，微信、QQ 等 App 依旧无法上网
