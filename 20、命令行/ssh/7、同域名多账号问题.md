假设有两个github账号：大号zhaiduting，小号117502385。要想让这两个账号都可以通过ssh正常访问github.com，就需要用到主机的别名。

### 要实现的目标：

- 大号保持不变，测试连接时依旧使用 `ssh -T git@github.com`
- 小号改用 `ssh -T git@github.com-sub`，此命令中的 `github.com-sub` 是GitHub主机的别名（随便起）。

### 方法概要

可以通过配置不同的主机别名来实现目标。先将 `$HOME/.ssh/config` 文件的主体结构改成下面这样

```yaml
# 大号配置
Host github.com
    IdentityFile ~/.ssh/github_ed25519

# GitHub 小号配置
Host github.com-sub
    HostName github.com
    IdentityFile ~/.ssh/github_qq
```

此配置的一般结构为

```
Host <主机别名>
    HostName <真实主机名>
    IdentityFile <私钥文件>
```

如果`<主机别名>`与`<真实主机名>`相同，则可以省略`HostName`这行（如大号所示）。

### 解决干扰

测试连接，输出信息如下

```shell
~ > ssh -T git@github.com-sub
Hi zhaiduting! You've successfully authenticated, but GitHub does not provide shell access.
~ > 
~ > ssh -T git@github.com    
Hi zhaiduting! You've successfully authenticated, but GitHub does not provide shell access.
```

其中大号的连接没有问题。但是连接 `github.com-sub` 时，输出了 `Hi zhaiduting`，这与期望的输出结果 `Hi 117502385` 不符。

这是因为ssh连接 `github.com-sub` 时，从 `github_ed25519` 与 `github_qq` 这两份私钥文件中随便挑选了一份。解决此问题的关键是增加 `IdentitiesOnly` 配置项，修改后的 config 文件如下所示

```yaml
# 大号配置
Host github.com
    IdentityFile ~/.ssh/github_ed25519
    IdentitiesOnly yes

# GitHub 小号配置
Host github.com-sub
    HostName github.com
    IdentityFile ~/.ssh/github_qq
    IdentitiesOnly yes
```

有了 `IdentitiesOnly yes` 的限制，ssh连接 `github.com-sub` 时，就不会随机挑选密钥了，而是固定选择对应的 `github_qq` 文件。这样一来，就不会再发生多份密钥彼此之间互相干扰的问题了。

### 小号用法

与大号用法几乎完全相同，仅仅是主机名多了一个 `-sub` 而已（取决于 `$HOME/.ssh/config` 文件内小号配置的主机别名）

#### 克隆示例

```shell
# 默认使用大号克隆
git clone git@github.com:actions/starter-workflows.git

# 使用小号克隆
git clone git@github.com-sub:actions/starter-workflows.git
```

#### 新建仓库示例

```shell
git remote add qq git@github.com-sub:117502385/learn-github-action.git
```

以下为终端命令的完整记录

```shell
Last login: Fri Sep 12 13:31:46 on ttys000
learn-github-action > git init
已初始化空的 Git 仓库于 /Users/zdt/Code/learn-github-action/.git/
learn-github-action > git add .
learn-github-action > git commit -m 新建
[main（根提交） 9fbeda1] 新建
 5 files changed, 111 insertions(+)
 create mode 100644 .github/workflows/1.yml
 create mode 100644 .github/workflows/test.yml
 create mode 100644 .gitignore
 create mode 100644 package-lock.json
 create mode 100644 package.json
learn-github-action >
learn-github-action > git remote add qq git@github.com-sub:117502385/learn-github-action.git
learn-github-action > git remote -v
qq	git@github.com-sub:117502385/learn-github-action.git (fetch)
qq	git@github.com-sub:117502385/learn-github-action.git (push)
learn-github-action >
learn-github-action > git push
Connection to ssh.github.com port 443 [tcp/https] succeeded!
枚举对象中: 9, 完成.
对象计数中: 100% (9/9), 完成.
使用 12 个线程进行压缩
压缩对象中: 100% (8/8), 完成.
写入对象中: 100% (9/9), 2.09 KiB | 2.09 MiB/s, 完成.
总共 9（差异 0），复用 0（差异 0），包复用 0（来自  0 个包）
To github.com-sub:117502385/learn-github-action.git
 * [new branch]      main -> main
分支 'main' 设置为跟踪 'qq/main'。
learn-github-action > git status
位于分支 main
您的分支与上游分支 'qq/main' 一致。

无文件要提交，干净的工作区
learn-github-action >
learn-github-action > git gui
learn-github-action >
```
