创建多个集群时，最后创建的集群为当前集群。使用 kubectl 命令操作的都是当前集群，它是通过 kubeconfig 里的「context（上下文）」来决定当前操作的是哪个集群 。当前集群的查询、切换命令如下

```sh
kubectl config use-context <kind-xxx>
```

终端记录如下

```sh
# 查询所有集群（cluster 有 s）
~ > kind get clusters
enabling experimental podman provider
dev-cluster
kind
~ >

# 查询当前集群（kind 在生成 kubeconfig 时，不会直接使用集群名，而是统一加前缀 kind- 前缀）
~ > kubectl config current-context
kind-kind

# 查询所有集群上下文
~ > kubectl config get-contexts
CURRENT   NAME               CLUSTER            AUTHINFO           NAMESPACE
          kind-dev-cluster   kind-dev-cluster   kind-dev-cluster
*         kind-kind          kind-kind          kind-kind
~ >

# 重点命令：切换当前集群
~ > kubectl config use-context kind-dev-cluster
Switched to context "kind-dev-cluster".
~ >

# 星号的指向已变
~ > kubectl config get-contexts
CURRENT   NAME               CLUSTER            AUTHINFO           NAMESPACE
*         kind-dev-cluster   kind-dev-cluster   kind-dev-cluster
          kind-kind          kind-kind          kind-kind
~ >
~ > kubectl config current-context
kind-dev-cluster
~ >
```

为方便学习和测试，以后直接使用默认集群。

### 当前集群未设置

此时无法执行 pod 创建命令及其它上下文相关的命令

```sh
# 存在 kind 集群
~ > kind get clusters
enabling experimental podman provider
kind

# 查询到当前集群的上下文未设置
# 这是因为创建了一个名为 xxx 的集群后改变了当前上下文的指向，
# 接着又删除了 xxx 集群，最终导致当前上下文为空
~ > kubectl config current-context
error: current-context is not set
~ > kubectl config get-contexts
CURRENT   NAME        CLUSTER     AUTHINFO    NAMESPACE
          kind-kind   kind-kind   kind-kind

# 尝试运行一个 busybox 直接报错
~ > kubectl run debug --image=busybox -it --rm -- sh
E0101 12:12:47.292815   32691 memcache.go:265] "Unhandled Error" err="couldn't get current server API group list: Get \"http://localhost:8080/api?timeout=32s\": dial tcp 127.0.0.1:8080: connect: connection refused"
The connection to the server localhost:8080 was refused - did you specify the right host or port?

# 解决方法：设置一个有效的集群上下文
# 不存在 "kind-kink"，报错
# 存在 "kind-kind"，设置有效
~ > kubectl config use-context kind-kink
error: no context exists with the name: "kind-kink"
~ > kubectl config use-context kind-kind
Switched to context "kind-kind".

# 再次运行 busybox 时一切正常
~ > kubectl run debug --image=busybox -it --rm -- sh
All commands and output from this session will be recorded in container logs, including credentials and sensitive information passed through the command prompt.
If you don't see a command prompt, try pressing enter.
/ # hostname
debug
/ # whoami
root
```
